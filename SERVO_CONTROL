#include <Servo.h>
Servo servo;

void setup() {

Serial.begin(9600);
adc_init();
servo.attach(12);
servo.write(0);



  
}

void loop(){
  
 
  unsigned int adc_reading = adc_read(10);
  //adc_reading = map(adc_reading , 0, 1023, 0, 180);     // scale it to use it with the servo (value between 0 and 180)
  servo.write(adc_reading);   
  Serial.println(adc_reading);// sets the servo position according to the scaled value
  delay(20);
 
  
  
}


void adc_init(){
  *my_ADCSRA |= 0x80;
  *my_ADCSRA &= 0xDF;       //0b11010000
   *my_ADCSRA &= 0xF7;
    *my_ADCSRA &= 0xF8;
    
  *my_ADCSRB &= 0xF7;
  *my_ADCSRB &= 0xF8;

  *my_ADMUX &= 0x7F;
  *my_ADMUX |= 0x40;
  *my_ADMUX &= 0xDF;
  *my_ADMUX &= 0xE0;
}

unsigned int adc_read(unsigned char adc_channel_num){
  *my_ADMUX &= 0xE0;
  *my_ADCSRB &= 0xF7;
  *my_ADMUX |= adc_channel_num;
  
  *my_ADCSRA |= 0x40;
  
  while(((*my_ADCSRA & 0x40) != 0));
  return *my_ADC_DATA;
  
}
